{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { readFileSync } from \"fs\";\nimport metadata from \"./metadata\";\nimport { NestFactory } from \"@nestjs/core\";\nimport { NestExpressApplication } from \"@nestjs/platform-express\";\nimport { AppModule } from \"./app.module\";\nimport { ConfigService } from \"@nestjs/config\";\nimport { SwaggerModule } from \"@nestjs/swagger\";\nimport { CommonLogger, EnableSwagger } from \"cc.naily.element.shared\";\n\n(async function bootstrap() {\n  console.clear();\n  const app = await NestFactory.create<NestExpressApplication>(AppModule, {\n    snapshot: true,\n    logger: new CommonLogger(),\n    cors: {\n      origin: \"*\",\n    },\n  });\n  app.useLogger(await app.resolve(CommonLogger));\n  const configService = app.get(ConfigService);\n  const port = configService.getOrThrow(\"shop.port\");\n  const name = configService.getOrThrow(\"shop.name\");\n\n  // Swagger\n  await SwaggerModule.loadPluginMetadata(metadata);\n  const [openAPIObject, generate] = EnableSwagger(app, (builder) => {\n    return builder.setTitle(name).setDescription(readFileSync(\"./DESC.md\").toString(\"utf-8\"));\n  });\n  generate(\"passport.openapi.json\", openAPIObject).then();\n  await app.listen(port);\n  return app;\n})().then(async (app) => {\n  new CommonLogger(\"NestApplication\").verbose(`Passport app is running on ${await app.getUrl()}`);\n});\n"],"names":["bootstrap","console","clear","app","NestFactory","create","AppModule","snapshot","logger","CommonLogger","cors","origin","useLogger","resolve","configService","get","ConfigService","port","getOrThrow","name","SwaggerModule","loadPluginMetadata","metadata","openAPIObject","generate","EnableSwagger","builder","setTitle","setDescription","readFileSync","toString","then","listen","verbose","getUrl"],"mappings":";;;;oBAA6B;iEACR;sBACO;2BAEF;wBACI;yBACA;sCACc;;;;;;AAE3C,CAAA,eAAeA;IACdC,QAAQC,KAAK;IACb,MAAMC,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAAyBC,oBAAS,EAAE;QACtEC,UAAU;QACVC,QAAQ,IAAIC,kCAAY;QACxBC,MAAM;YACJC,QAAQ;QACV;IACF;IACAR,IAAIS,SAAS,CAAC,MAAMT,IAAIU,OAAO,CAACJ,kCAAY;IAC5C,MAAMK,gBAAgBX,IAAIY,GAAG,CAACC,qBAAa;IAC3C,MAAMC,OAAOH,cAAcI,UAAU,CAAC;IACtC,MAAMC,OAAOL,cAAcI,UAAU,CAAC;IAEtC,UAAU;IACV,MAAME,sBAAa,CAACC,kBAAkB,CAACC,iBAAQ;IAC/C,MAAM,CAACC,eAAeC,SAAS,GAAGC,IAAAA,mCAAa,EAACtB,KAAK,CAACuB;QACpD,OAAOA,QAAQC,QAAQ,CAACR,MAAMS,cAAc,CAACC,IAAAA,gBAAY,EAAC,aAAaC,QAAQ,CAAC;IAClF;IACAN,SAAS,yBAAyBD,eAAeQ,IAAI;IACrD,MAAM5B,IAAI6B,MAAM,CAACf;IACjB,OAAOd;AACT,CAAA,IAAK4B,IAAI,CAAC,OAAO5B;IACf,IAAIM,kCAAY,CAAC,mBAAmBwB,OAAO,CAAC,CAAC,2BAA2B,EAAE,MAAM9B,IAAI+B,MAAM,GAAG,CAAC;AAChG"}