{"version":3,"sources":["../../../src/modules/product/product.controller.ts"],"sourcesContent":["import { Controller, Get, Query, UseInterceptors } from \"@nestjs/common\";\nimport { ApiTags } from \"@nestjs/swagger\";\nimport { ShopProductRepository } from \"cc.naily.element.database\";\nimport { GetProductDTO } from \"./dtos/product/product.dto\";\nimport { ResInterceptor } from \"cc.naily.element.shared\";\n\n@ApiTags(\"产品\")\n@Controller(\"product\")\nexport class ProductController {\n  constructor(private readonly shopProductRepository: ShopProductRepository) {}\n\n  /**\n   * 获取商品列表\n   *\n   * @author Zero <gczgroup@qq.com>\n   * @date 2024/01/19\n   * @memberof ProductController\n   */\n  @Get()\n  @UseInterceptors(ResInterceptor)\n  public listProduct(@Query() query: GetProductDTO): Promise<Array<any>> {\n    if (typeof query.filterTags === \"string\") query.filterTags = [query.filterTags];\n    return this.shopProductRepository.find({\n      cache: true,\n      order: {\n        productID: query.orderTime === \"oldtest\" ? \"ASC\" : \"DESC\",\n      },\n      where: (query.filterTags || []).map((item) => {\n        return {\n          productStatus: \"up\",\n          productTags: {\n            productTagID: item,\n          },\n        };\n      }),\n    });\n  }\n}\n"],"names":["ProductController","listProduct","query","filterTags","shopProductRepository","find","cache","order","productID","orderTime","where","map","item","productStatus","productTags","productTagID","constructor","Get","UseInterceptors","ResInterceptor","Query","ApiTags","Controller"],"mappings":";;;;+BAQaA;;;eAAAA;;;wBAR2C;yBAChC;wCACc;4BACR;sCACC;;;;;;;;;;;;;;;AAIxB,IAAA,AAAMA,oBAAN,MAAMA;IAGX;;;;;;GAMC,GACD,AAEOC,YAAY,AAASC,KAAoB,EAAuB;QACrE,IAAI,OAAOA,MAAMC,UAAU,KAAK,UAAUD,MAAMC,UAAU,GAAG;YAACD,MAAMC,UAAU;SAAC;QAC/E,OAAO,IAAI,CAACC,qBAAqB,CAACC,IAAI,CAAC;YACrCC,OAAO;YACPC,OAAO;gBACLC,WAAWN,MAAMO,SAAS,KAAK,YAAY,QAAQ;YACrD;YACAC,OAAO,AAACR,CAAAA,MAAMC,UAAU,IAAI,EAAE,AAAD,EAAGQ,GAAG,CAAC,CAACC;gBACnC,OAAO;oBACLC,eAAe;oBACfC,aAAa;wBACXC,cAAcH;oBAChB;gBACF;YACF;QACF;IACF;IA3BAI,YAAY,AAAiBZ,qBAA4C,CAAE;aAA9CA,wBAAAA;IAA+C;AA4B9E;;IAnBGa,IAAAA,WAAG;IACHC,IAAAA,uBAAe,EAACC,oCAAc;IACXC,aAAAA,IAAAA,aAAK;;;eAAU,yBAAa,4BAAb,yBAAa;;6CAAG,mCAAA;GAZxCpB;AAAAA;IAFZqB,IAAAA,gBAAO,EAAC;IACRC,IAAAA,kBAAU,EAAC;;;eAE0C,6CAAqB,4BAArB,6CAAqB;;GAD9DtB"}